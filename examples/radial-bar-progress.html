<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Gauge Test Progress Radial</title>
    <style>body {
        padding: 0;
        margin: 0;
        background: #fff
    }</style>
</head>
<body>

<button onclick="animateGauges()">Animate</button>
<button onclick="stopGaugesAnimation()">Stop animation</button>

<hr>

<canvas data-type="radial-gauge"
    data-width="150"
    data-height="150"
    data-units="Loading"
    data-min-value="0"
    data-max-value="100"

    data-color-plate="transparent"

    data-ticks-angle="315"
    data-start-angle="25"
    data-stroke-ticks="false"
    data-major-ticks="[,]"
    data-minor-ticks="0"
    data-highlights='[]'
    data-highlights-width="25"

    data-border-shadow-width="0"
    data-border-inner-width="1"
    data-border-middle-width="0"
    data-border-outer-width="0"
    data-borders="true"
    data-color-border-shadow="false"
    data-color-border-inner="#eee"
    data-color-border-inner-end="#eee"


    data-bar-progress="true"
    data-bar-width="30"
    data-bar-shadow="#f00"
    data-bar-stroke-width="0"

    data-color-bar="transparent"
    data-color-major-ticks="transparent"

    data-value-box="true"
    data-color-value-box="transparent"
    data-color-value-text="rgba(0,200,200,.75)"
    data-color-value-text-shadow="false"
    data-color-value-box-rect="transparent"
    data-color-value-box-background="transparent"

    data-font-units-size="50"
    data-font-value-size="75"
    data-value-text-shadow="false"
    data-value-int="2"
    data-value-dec="0"
    data-value-box-stroke="0"

    data-needle="false"
    data-animation-rule="linear"
    data-animation-duration="50"
></canvas>

<script async src="../gauge.min.js"></script>

<script>
if (!Array.prototype.forEach) {
    Array.prototype.forEach = function(cb) {
        var i = 0, s = this.length;
        for (; i < s; i++) {
            cb && cb(this[i], i, this);
        }
    }
}

document.fonts && document.fonts.forEach(function(font) {
    font.loaded.then(function() {
        if (font.family.match(/Led/)) {
            document.gauges.forEach(function(gauge) {
                gauge.update();
            });
        }
    });
});

var timers = [];

function animateGauges() {
    document.gauges.forEach(function(gauge) {
        gauge.value = gauge.options.minValue;
    });
    document.gauges.forEach(function(gauge) {
        timers.push(setInterval(function() {
            if (gauge.value == gauge.options.maxValue) {
                gauge.value = gauge.options.minValue;
            }
            gauge.value = gauge.value + 1;
        }, gauge.animation.duration + 25));
    });
}

function stopGaugesAnimation() {
    timers.forEach(function(timer) {
        clearInterval(timer);
    });
}
</script>

</body>
</html>
